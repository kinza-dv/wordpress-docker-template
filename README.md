# Шаблон Wordpress в Docker

## Обзор

Шаблон Wordpress предназначен для установки на сервер и локальной разработки. Для использования нужно сделать clone и
rename. Затем через терминал удалить в корне директорию .git

### Структура каталогов

- `./deploy/...`: Каталог с файлами для деплоя и конфигурацией Nginx.
- `./wordpress/`: Каталог для хранения файлов wordpress.

### Начало работы

1. Создайте .env из .enc.example

#### Параметры приложения

| Ключ                    | Значение                        | Примечания                                                                |
|-------------------------|---------------------------------|---------------------------------------------------------------------------|
| `WORDPRESS_DB_HOST`     | Хост базы данных                | Если запуск через докер, то ставим имя_контейнера_бд, ручками - localhost |
| `WORDPRESS_DB_USER`     | Имя пользователя базы данных    | Должен быть отличен от стандартного пользователя базы данных              |
| `WORDPRESS_DB_PASSWORD` | Пароль к базе данных            | Должен быть отличен от стандартного пароля базы данных                    |
| `WORDPRESS_DB_NAME`     | Имя базы данных                 | Имя вашей базы данных                                                     |
| `WORDPRESS_DEBUG`       | Настройка режима отладки        | По умолчанию FALSE, для включения отладки ставим TRUE                     |
| `MYSQL_ROOT_PASSWORD`   | Пароль суперпользователя MySQL  | Обязательное поле                                                         |
| `MYSQL_DATABASE`        | Имя базы данных                 | По умолчанию 5432                                                         |
| `MYSQL_USER`            | Имя пользователя базы данных    | Должен быть отличен от стандартного пользователя базы данных              |
| `MYSQL_PASSWORD`        | Пароль пользователя базы данных | Должен быть отличен от стандартного пароля базы данных                    |

### Запуск для разработки

1. В корневой директории:

```shell
docker-compose up --build
```

2. Для остановки контейнеров используем ctrl+C и команду в терминале:

```shell
docker-compose down
```

### Запуск в проде

1. В корневой директории:

```shell
docker-compose -f docker-compose.prod.yml up --build
```

2. Для остановки контейнеров в ssh терминале последовательно:

```shell
docker stop $(docker ps -aq)
```

```shell
docker-compose down
```

```shell
docker system prune -a
```

### Настройка HTTPS и SSL

1. Переходим на url: "http://<host_ip>:81"
2. Вводим почту и пароль: admin@example.com/changeme
3. Меняем почту и пароль
4. В параметре source указываем: приобретенный домен (если бесплатно для тестов name.<host_ip>.nip.io)
5. В параметре destination указываем: "http://<host_ip>:8080"
6. Добавляем SSL сертификат "Let's Encrypt"
7. Ставим Force в True